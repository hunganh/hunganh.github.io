window.variablesJS.divSummaryShowData=document.getElementById("showSummaryData"),window.variablesJS.divSummaryTitle=document.getElementById("showSummaryTitle"),window.summaryJS={resetDataSummary:function(){window.variablesJS.summaryDataJson=null,window.variablesJS.divSummaryShowData.innerHTML=""},refreshSummaryData:function(){window.summaryJS.resetDataSummary(),window.summaryJS.initSummaryData()},initSummaryData:function(){window.summaryJS.resetDataSummary(),window.commonJS.showLoading("showSummaryLoading"),Promise.all([window.commonJS.fetchContentByUrl(window.apiUrlDefined.SYNTHESIS_DATA_URL)]).then((a=>{a&&a.length>0&&window.summaryJS.setSummaryDataGlobal(a),window.commonJS.hideLoading("showSummaryLoading")})).then((()=>{})).catch((a=>{console.error(a)}))},setSummaryDataGlobal:function(a){window.summaryJS.resetDataSummary(),a&&a.length>0&&(window.variablesJS.summaryDataJson=a[0],window.summaryJS.processSummaryDataInput())},processSummaryDataInput:function(){var a=[],e=window.variablesJS.summaryDataJson.selfBusiness[window.variablesJS.currentSummaryPeriod][window.variablesJS.actionSummaryDefault],n=window.variablesJS.summaryDataJson.foreign[window.variablesJS.currentSummaryPeriod][window.variablesJS.actionSummaryDefault],r=e.map((a=>a.ticker)),i=n.map((a=>a.ticker)),o=r.filter((a=>-1!==i.indexOf(a)));o&&o.length>0&&o.forEach((r=>{var i=e.find((a=>a.ticker===r)),o=n.find((a=>a.ticker===r));if(i&&o){var t={ticker:r,totalNetBuyTradeValue:i.totalNetBuyTradeValue,selfBusinessPercentPriceChange:i.percentPriceChange,selfBusinessPriceChange:i.priceChange,selfBusinessMatchPrice:i.matchPrice,foreignNetBuyValue:o.foreignNetBuyValue,foreignPercentPriceChange:o.percentPriceChange,foreignPriceChange:o.priceChange,foreignMatchPrice:o.matchPrice,sumValue:0};t.sumValue=t.totalNetBuyTradeValue+t.foreignNetBuyValue,a.push(t)}})),a&&a.length>0&&a.sort((function(a,e){return e.sumValue-a.sumValue})),window.summaryJS.createSummaryReport(a),window.summaryJS.setSummaryTitle(),window.commonJS.hideLoading("showSummaryLoading")},createSummaryReport:function(a){var e="Thống Kê Từ "+new Date(window.variablesJS.summaryDataJson.foreign[window.variablesJS.currentSummaryPeriod].fromDate).toLocaleDateString(window.variablesJS.defaultLocale)+" - "+new Date(window.variablesJS.summaryDataJson.foreign[window.variablesJS.currentSummaryPeriod].toDate).toLocaleDateString(window.variablesJS.defaultLocale),n=document.createElement("table");n.classList.add("left-position","table","table-bordered","table-striped","table-hover");var r=document.createElement("thead"),i=r.insertRow(-1),o=document.createElement("th");o.setAttribute("colspan",10),o.innerHTML=e,i.appendChild(o),r.appendChild(i),n.appendChild(r),i=r.insertRow(-1);for(var t=0;t<variablesJS.summaryHeadTitle.length;t++){var m=document.createElement("th");t==variablesJS.summaryHeadTitle.length-2?m.setAttribute("colspan",2):m.setAttribute("rowspan",2),m.innerHTML=variablesJS.summaryHeadTitle[t],i.appendChild(m)}i=r.insertRow(-1);for(var s=0;s<variablesJS.subSummaryHeadTitle.length;s++)(m=document.createElement("th")).innerHTML=variablesJS.subSummaryHeadTitle[s],i.appendChild(m);var l=document.createElement("tbody");if(l.setAttribute("id","table-summary-popover"),a.length>0)for(t=0;t<a.length;t++){(i=l.insertRow(-1)).setAttribute("onClick",`window.commonJS.showTickerInfor("${a[t].ticker}")`),i.classList.add("tr-cursor");var d=a[t].foreignMatchPrice,w=a[t].foreignPriceChange,u=100*a[t].foreignPercentPriceChange,c=u>0||u<0?w/a[t].foreignPercentPriceChange:a[t].foreignMatchPrice;window.commonJS.addCell(i,Number(t+1)),window.commonJS.addCell(i,`<b class="top10">${a[t].ticker}</span>`),window.commonJS.addCell(i,'<div class="text-left">'+window.commonJS.getIcbNameBySymbol(a[t].ticker)+"</div>"),window.commonJS.addCell(i,`<span class='${window.commonJS.getClassByValue(w)}'>${new Intl.NumberFormat(window.variablesJS.numberLocale).format(d)}</span>`),window.commonJS.addCell(i,`<span class='${window.commonJS.getClassByValue(w)}'>${new Intl.NumberFormat(window.variablesJS.numberLocale).format(w)}</span>`),window.commonJS.addCell(i,`<span class='${window.commonJS.getClassByValue(u)}'>${u.toFixed(2)}%</span>`),window.commonJS.addCell(i,new Intl.NumberFormat(window.variablesJS.numberLocale).format(c.toFixed(0))),window.commonJS.addCell(i,`<span class='text-right'>${new Intl.NumberFormat(window.variablesJS.numberLocale).format(a[t].totalNetBuyTradeValue)}</span>`),window.commonJS.addCell(i,`<span class='text-right'>${new Intl.NumberFormat(window.variablesJS.numberLocale).format(a[t].foreignNetBuyValue)}</span>`),window.commonJS.addCell(i,`<span class='bold text-right top10'>${new Intl.NumberFormat(window.variablesJS.numberLocale).format(a[t].sumValue)}</span>`)}else{var S=(i=l.insertRow(-1)).insertCell(-1);S.innerHTML="Không có dữ liệu.",S.colSpan=10}n.appendChild(l),window.variablesJS.divSummaryShowData.appendChild(n)},changePeriodAction:function(a){window.variablesJS.currentSummaryPeriod=a,null!==window.variablesJS.summaryDataJson?(window.variablesJS.divSummaryShowData.innerHTML="",window.commonJS.showLoading("showSummaryLoading"),window.summaryJS.processSummaryDataInput()):window.summaryJS.initSummaryData()},changeSummaryAction:function(a){variablesJS.actionSummaryDefault=a,null!==window.variablesJS.summaryDataJson?(window.variablesJS.divSummaryShowData.innerHTML="",window.commonJS.showLoading("showSummaryLoading"),window.summaryJS.processSummaryDataInput()):window.summaryJS.initSummaryData()},setSummaryTitle:function(){var a=(new Date).toLocaleDateString(window.variablesJS.defaultLocale),e=new Date(window.variablesJS.summaryDataJson.foreign[window.variablesJS.currentSummaryPeriod].toDate).toLocaleDateString(window.variablesJS.defaultLocale),n=` ${window.variablesJS.dataJson&&window.variablesJS.dataJson.items.length>0?"- Dữ liệu ngày "+e:""} `;e===a?(window.variablesJS.divSummaryTitle.classList.remove("bg-out-of-date"),window.variablesJS.divSummaryTitle.classList.add("bg-latest")):(window.variablesJS.divSummaryTitle.classList.remove("bg-latest"),window.variablesJS.divSummaryTitle.classList.add("bg-out-of-date")),window.variablesJS.divSummaryTitle.innerHTML=`Mã CP Được Tổ Chức Trong Nước & Khối Ngoại ${"netBuy"===variablesJS.actionSummaryDefault?"Mua Ròng":"Bán Ròng"}${n}`,window.commonJS.closePopover(),window.commonJS.initIndustriesSelectionPopover("summary-popover")}},document.addEventListener("DOMContentLoaded",(function(a){window.summaryJS.initSummaryData()}));